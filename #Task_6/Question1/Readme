The question was really challenging. I Have made solution for this problem which is also passing all the test cases but I stil feel that it can give error in someother test cases  
